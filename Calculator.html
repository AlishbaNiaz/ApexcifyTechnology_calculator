<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Modern Calculator</title>
    <style>
      :root {
        --bg: #0e0f12;
        --panel: #14161b;
        --key: #23262e;
        --key-hover: #2b2f38;
        --accent: #fea00a;
        --accent-2: #ffb23e;
        --text: #f5f7fb;
        --muted: #a6adbb;
        --shadow: rgba(0, 0, 0, 0.45);
        --radius: 18px;
      }

      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        background: radial-gradient(
          60% 80% at 70% 10%,
          #1b1d24 0%,
          #0e0f12 60%
        );
        color: var(--text);
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto,
          Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        display: grid;
        place-items: center;
        padding: 24px;
      }

      .calculator {
        width: min(420px, 96vw);
        background: linear-gradient(
            180deg,
            rgba(255, 255, 255, 0.02),
            rgba(255, 255, 255, 0)
          ),
          var(--panel);
        border-radius: var(--radius);
        box-shadow: 0 20px 50px var(--shadow),
          inset 0 1px 0 rgba(255, 255, 255, 0.04);
        overflow: hidden;
      }

      .display {
        padding: 24px 20px 10px;
        min-height: 110px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        align-items: flex-end;
        justify-content: flex-end;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.04),
          rgba(255, 255, 255, 0)
        );
      }
      .history {
        color: var(--muted);
        font-size: 14px;
        min-height: 20px;
        word-break: break-all;
        opacity: 0.85;
      }
      .result {
        font-size: 44px;
        font-weight: 700;
        letter-spacing: 1px;
        word-break: break-all;
      }

      .keys {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 12px;
        padding: 16px;
      }

      button {
        appearance: none;
        border: 0;
        cursor: pointer;
        user-select: none;
        height: 64px;
        border-radius: 16px;
        font-size: 20px;
        font-weight: 600;
        color: var(--text);
        background: var(--key);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.35),
          inset 0 -2px 0 rgba(255, 255, 255, 0.02);
        transition: transform 0.06s ease, background 0.15s ease,
          box-shadow 0.15s ease, filter 0.15s ease;
      }
      button:hover {
        background: var(--key-hover);
      }
      button:active {
        transform: translateY(1px);
        filter: brightness(0.98);
      }
      button:focus-visible {
        outline: 2px solid var(--accent);
        outline-offset: 2px;
      }

      .btn-operator {
        color: #ffd18a;
      }
      .btn-accent {
        background: linear-gradient(180deg, var(--accent-2), var(--accent));
        color: #1b1102;
        box-shadow: 0 10px 24px rgba(254, 160, 10, 0.35);
      }
      .btn-accent:hover {
        filter: brightness(1.05);
      }
      .btn-accent:active {
        transform: translateY(1px);
      }

      .span-2 {
        grid-column: span 2;
      }

      @media (max-width: 360px) {
        .result {
          font-size: 36px;
        }
        button {
          height: 58px;
          font-size: 18px;
        }
      }
    </style>
  </head>
  <body>
    <main class="calculator" role="application" aria-label="Calculator">
      <section class="display" aria-live="polite">
        <div class="history" id="history"></div>
        <div class="result" id="display">0</div>
      </section>

      <section class="keys">
        <button class="btn-operator" data-action="clear" aria-label="All Clear">
          AC
        </button>
        <button class="btn-operator" data-action="delete" aria-label="Delete">
          DEL
        </button>
        <button class="btn-operator" data-value="%" aria-label="Percent">
          %
        </button>
        <button class="btn-operator" data-value="/" aria-label="Divide">
          ÷
        </button>

        <button data-value="7">7</button>
        <button data-value="8">8</button>
        <button data-value="9">9</button>
        <button class="btn-operator" data-value="*" aria-label="Multiply">
          ×
        </button>

        <button data-value="4">4</button>
        <button data-value="5">5</button>
        <button data-value="6">6</button>
        <button class="btn-operator" data-value="-" aria-label="Minus">
          −
        </button>

        <button data-value="1">1</button>
        <button data-value="2">2</button>
        <button data-value="3">3</button>
        <button class="btn-operator" data-value="+" aria-label="Plus">+</button>

        <button class="span-2" data-value="0">0</button>
        <button data-value=".">.</button>
        <button class="btn-accent" data-action="equals" aria-label="Equals">
          =
        </button>
      </section>
    </main>

    <script>
      const display = document.getElementById("display");
      const history = document.getElementById("history");
      const keys = document.querySelector(".keys");

      let expr = "";
      let lastResult = null;

      const updateUI = () => {
        display.textContent = expr || "0";
        history.textContent = lastResult !== null ? `Ans = ${lastResult}` : "";
      };

      const safeEval = (raw) => {
        const normalized = raw.replace(/×/g, "*").replace(/÷/g, "/");
        if (!/^[-+*/%.()\d\s]+$/.test(normalized))
          throw new Error("Invalid input");
        const percentHandled = normalized.replace(/(\d+(?:\.\d+)?)%/g, (m, n) =>
          String(Number(n) / 100)
        );
        return Function(`"use strict"; return (${percentHandled})`)();
      };

      const append = (val) => {
        if (/[-+*/.]/.test(val) && /[-+*/.]$/.test(expr)) {
          expr = expr.replace(/.$/, val);
        } else {
          expr += val;
        }
        updateUI();
      };

      const doEquals = () => {
        if (!expr) return;
        try {
          const result = safeEval(expr);
          lastResult = result;
          display.textContent = String(result);
          history.textContent = expr + " =";
          expr = String(result);
        } catch (e) {
          display.textContent = "Error";
          expr = "";
        }
      };

      const doDelete = () => {
        expr = expr.slice(0, -1);
        updateUI();
      };
      const doClear = () => {
        expr = "";
        lastResult = null;
        updateUI();
      };

      keys.addEventListener("click", (e) => {
        const btn = e.target.closest("button");
        if (!btn) return;
        const { value } = btn.dataset;
        const action = btn.dataset.action;
        if (action === "equals") return doEquals();
        if (action === "delete") return doDelete();
        if (action === "clear") return doClear();
        if (value !== undefined) return append(value);
      });

      window.addEventListener("keydown", (e) => {
        const k = e.key;
        if (/^[0-9]$/.test(k)) return append(k);
        if ("+-*/.".includes(k)) return append(k);
        if (k === "Enter" || k === "=") return doEquals();
        if (k === "Backspace") return doDelete();
        if (k === "Escape") return doClear();
        if (k === "%") return append("%");
      });

      updateUI();
    </script>
  </body>
</html>
